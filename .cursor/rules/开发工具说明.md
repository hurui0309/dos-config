# 数据库工具使用说明
## 功能描述
该工具用于连接指定数据源并执行SQL操作，支持：
- DQL(SELECT/SHOW/DESC等)
- DML(INSERT/UPDATE/DELETE)
- DDL(CREATE/ALTER/DROP等)

## 调用方式
```bash
python devtools/db_tool.py -d [数据源名称] -s "SQL语句"
```

## 参数说明
- `-d/--datasource`: 数据源名称(可选)
  - 为空时使用默认jdbc配置
  - 指定时使用`{datasourceName}.jdbc.`前缀的配置
- `-s/--sql`: 要执行的SQL语句(必填)
- `-p/--props`: application.properties文件路径(可选，默认src/main/resources/application.properties)

## 功能特性
1. 自动识别SQL类型并执行相应操作
2. 支持事务处理(DML操作自动使用事务)
3. 支持多语句执行(用分号分隔)
4. 返回格式化的执行结果

## 示例
1. 查询数据:
```bash
python devtools/db_tool.py -d tidb_dosquery -s "SELECT * FROM table LIMIT 10"
```

2. 插入数据:
```bash
python devtools/db_tool.py -d tidb_dosquery -s "INSERT INTO table(field1,field2) VALUES('value1','value2')"
```

3. 查看表结构:
```bash
python devtools/db_tool.py -d tidb_dosquery -s "show creata table new_table"
```

## 注意事项
1. 需要安装Python3和pymysql库: `pip install pymysql`
2. 确保application.properties中有对应的数据源配置
3. DDL操作(CREATE/ALTER/DROP)会自动提交
4. DML操作(INSERT/UPDATE/DELETE)会自动使用事务
5. 查询结果以字典形式返回，字段名为键