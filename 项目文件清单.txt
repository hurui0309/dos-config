æŒ‡æ ‡å¼‚åŠ¨æ ¹å› å®šä½ç³»ç»Ÿ - å®Œæ•´æ–‡ä»¶æ¸…å•
===========================================

é¡¹ç›®æ ¹ç›®å½•ï¼šD:\AI\RootCause

ğŸ“ æ ¹ç›®å½•æ–‡ä»¶
â”œâ”€â”€ pom.xml                          # Mavené¡¹ç›®é…ç½®æ–‡ä»¶
â”œâ”€â”€ README.md                        # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ é¡¹ç›®å®ç°è¯´æ˜.md                  # è¯¦ç»†å®ç°è¯´æ˜
â”œâ”€â”€ é¡¹ç›®æ–‡ä»¶æ¸…å•.txt                 # æœ¬æ–‡ä»¶
â”œâ”€â”€ api-test.http                    # APIæ¥å£æµ‹è¯•è„šæœ¬
â”œâ”€â”€ .gitignore                       # Gitå¿½ç•¥é…ç½®
â””â”€â”€ CLAUDE.md                        # åŸæœ‰çš„é¡¹ç›®å‚è€ƒæ–‡æ¡£

ğŸ“ æ•°æ®åº“è„šæœ¬
â””â”€â”€ dbScript/
    â””â”€â”€ v1.0.0/
        â””â”€â”€ init_schema.sql          # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬ï¼ˆå»ºè¡¨+æµ‹è¯•æ•°æ®ï¼‰

ğŸ“ æºä»£ç 
â””â”€â”€ src/
    â”œâ”€â”€ main/
    â”‚   â”œâ”€â”€ java/com/rootcause/
    â”‚   â”‚   â”œâ”€â”€ MetricAttributionApplication.java           # ä¸»å¯åŠ¨ç±»
    â”‚   â”‚   â”‚
    â”‚   â”‚   â”œâ”€â”€ common/                                     # å…¬å…±ç±»åŒ…
    â”‚   â”‚   â”‚   â””â”€â”€ ApiResponse.java                        # ç»Ÿä¸€å“åº”å°è£…
    â”‚   â”‚   â”‚
    â”‚   â”‚   â”œâ”€â”€ config/                                     # é…ç½®ç±»åŒ…
    â”‚   â”‚   â”‚   â””â”€â”€ JacksonConfig.java                      # Jacksoné…ç½®
    â”‚   â”‚   â”‚
    â”‚   â”‚   â”œâ”€â”€ controller/                                 # æ§åˆ¶å™¨åŒ…
    â”‚   â”‚   â”‚   â””â”€â”€ AttributionController.java              # å½’å› åˆ†ææ¥å£ï¼ˆ9ä¸ªAPIï¼‰
    â”‚   â”‚   â”‚
    â”‚   â”‚   â”œâ”€â”€ dto/                                        # DTOåŒ…
    â”‚   â”‚   â”‚   â”œâ”€â”€ request/                                # è¯·æ±‚DTO
    â”‚   â”‚   â”‚   â”‚   â””â”€â”€ CreateTaskRequest.java              # åˆ›å»ºä»»åŠ¡è¯·æ±‚
    â”‚   â”‚   â”‚   â””â”€â”€ response/                               # å“åº”DTO
    â”‚   â”‚   â”‚       â”œâ”€â”€ MetricBriefDTO.java                 # æŒ‡æ ‡ç®€è¦ä¿¡æ¯
    â”‚   â”‚   â”‚       â”œâ”€â”€ MetricPointDTO.java                 # æŒ‡æ ‡æ—¶åºç‚¹
    â”‚   â”‚   â”‚       â”œâ”€â”€ MetricTrendDTO.java                 # æŒ‡æ ‡è¶‹åŠ¿
    â”‚   â”‚   â”‚       â”œâ”€â”€ AttributionTreeBriefDTO.java        # å½’å› æ ‘ç®€è¦ä¿¡æ¯
    â”‚   â”‚   â”‚       â”œâ”€â”€ AttributionTreeConfigDTO.java       # å½’å› æ ‘é…ç½®
    â”‚   â”‚   â”‚       â”œâ”€â”€ MetricTreeNodeDTO.java              # æŒ‡æ ‡æ ‘èŠ‚ç‚¹
    â”‚   â”‚   â”‚       â”œâ”€â”€ TaskCreateDTO.java                  # ä»»åŠ¡åˆ›å»ºå“åº”
    â”‚   â”‚   â”‚       â”œâ”€â”€ AnalysisTaskDTO.java                # ä»»åŠ¡è¯¦æƒ…
    â”‚   â”‚   â”‚       â”œâ”€â”€ TaskListDTO.java                    # ä»»åŠ¡åˆ—è¡¨
    â”‚   â”‚   â”‚       â”œâ”€â”€ TaskStatusDTO.java                  # ä»»åŠ¡çŠ¶æ€
    â”‚   â”‚   â”‚       â”œâ”€â”€ AttributionResultDTO.java           # å½’å› åˆ†æç»“æœ
    â”‚   â”‚   â”‚       â”œâ”€â”€ AttributionTreeResultNodeDTO.java   # å½’å› ç»“æœèŠ‚ç‚¹
    â”‚   â”‚   â”‚       â”œâ”€â”€ DimensionAttributionItemDTO.java    # ç»´åº¦å½’å› æ˜ç»†
    â”‚   â”‚   â”‚       â”œâ”€â”€ AiAttributionReportDTO.java         # AIæŠ¥å‘Š
    â”‚   â”‚   â”‚       â””â”€â”€ ReportSectionDTO.java               # æŠ¥å‘Šç« èŠ‚
    â”‚   â”‚   â”‚
    â”‚   â”‚   â”œâ”€â”€ entity/                                     # å®ä½“ç±»åŒ…
    â”‚   â”‚   â”‚   â”œâ”€â”€ Metric.java                             # æ ¸å¿ƒæŒ‡æ ‡å®ä½“
    â”‚   â”‚   â”‚   â”œâ”€â”€ AttributionTree.java                    # å½’å› æ ‘é…ç½®å®ä½“
    â”‚   â”‚   â”‚   â”œâ”€â”€ AnalysisTask.java                       # åˆ†æä»»åŠ¡å®ä½“ï¼ˆå«roster_idï¼‰
    â”‚   â”‚   â”‚   â”œâ”€â”€ AttributionResult.java                  # å½’å› ç»“æœå®ä½“
    â”‚   â”‚   â”‚   â””â”€â”€ AiReport.java                           # AIæŠ¥å‘Šå®ä½“
    â”‚   â”‚   â”‚
    â”‚   â”‚   â”œâ”€â”€ enums/                                      # æšä¸¾ç±»åŒ…
    â”‚   â”‚   â”‚   â”œâ”€â”€ TaskStatus.java                         # ä»»åŠ¡çŠ¶æ€æšä¸¾
    â”‚   â”‚   â”‚   â”œâ”€â”€ ReportStatus.java                       # æŠ¥å‘ŠçŠ¶æ€æšä¸¾
    â”‚   â”‚   â”‚   â””â”€â”€ OperationType.java                      # è¿ç®—ç±»å‹æšä¸¾
    â”‚   â”‚   â”‚
    â”‚   â”‚   â”œâ”€â”€ exception/                                  # å¼‚å¸¸å¤„ç†åŒ…
    â”‚   â”‚   â”‚   â”œâ”€â”€ BusinessException.java                  # ä¸šåŠ¡å¼‚å¸¸ç±»
    â”‚   â”‚   â”‚   â””â”€â”€ GlobalExceptionHandler.java             # å…¨å±€å¼‚å¸¸å¤„ç†å™¨
    â”‚   â”‚   â”‚
    â”‚   â”‚   â”œâ”€â”€ repository/                                 # æ•°æ®è®¿é—®å±‚åŒ…
    â”‚   â”‚   â”‚   â”œâ”€â”€ MetricRepository.java                   # æŒ‡æ ‡Repository
    â”‚   â”‚   â”‚   â”œâ”€â”€ AttributionTreeRepository.java          # å½’å› æ ‘Repository
    â”‚   â”‚   â”‚   â”œâ”€â”€ AnalysisTaskRepository.java             # ä»»åŠ¡Repository
    â”‚   â”‚   â”‚   â”œâ”€â”€ AttributionResultRepository.java        # ç»“æœRepository
    â”‚   â”‚   â”‚   â””â”€â”€ AiReportRepository.java                 # æŠ¥å‘ŠRepository
    â”‚   â”‚   â”‚
    â”‚   â”‚   â””â”€â”€ service/                                    # æœåŠ¡å±‚åŒ…
    â”‚   â”‚       â”œâ”€â”€ AttributionService.java                 # æœåŠ¡æ¥å£ï¼ˆ9ä¸ªæ–¹æ³•ï¼‰
    â”‚   â”‚       â””â”€â”€ impl/
    â”‚   â”‚           â””â”€â”€ AttributionServiceImpl.java         # æœåŠ¡å®ç°ï¼ˆå«å¼‚æ­¥æ¡†æ¶å’ŒTODOï¼‰
    â”‚   â”‚
    â”‚   â””â”€â”€ resources/
    â”‚       â””â”€â”€ application.properties                      # åº”ç”¨é…ç½®æ–‡ä»¶
    â”‚
    â””â”€â”€ test/
        â””â”€â”€ java/                                           # æµ‹è¯•ä»£ç ç›®å½•ï¼ˆé¢„ç•™ï¼‰

ğŸ“ è§„åˆ™æ–‡æ¡£ï¼ˆ.cursor/rulesï¼‰
â””â”€â”€ .cursor/rules/
    â””â”€â”€ reference_info/
        â”œâ”€â”€ æŒ‡æ ‡å¼‚åŠ¨æ ¹å› å®šä½_APIæ¥å£æ–‡æ¡£.md               # APIæ¥å£è§„èŒƒ
        â”œâ”€â”€ æŒ‡æ ‡å¼‚åŠ¨æ ¹å› å®šä½_è¯¦ç»†è®¾è®¡.md                 # è¯¦ç»†è®¾è®¡æ–‡æ¡£
        â”œâ”€â”€ Adtributorç®—æ³•SQLå®ç°å¯è¡Œæ€§åˆ†æ.md           # ç®—æ³•åˆ†ææ–‡æ¡£
        â””â”€â”€ adtributor.py                                # Pythonç®—æ³•å‚è€ƒ

===========================================
ç»Ÿè®¡ä¿¡æ¯
===========================================

Javaæºæ–‡ä»¶æ€»æ•°ï¼š39ä¸ª

â”œâ”€â”€ ä¸»å¯åŠ¨ç±»ï¼š1
â”œâ”€â”€ å®ä½“ç±»ï¼ˆEntityï¼‰ï¼š5
â”œâ”€â”€ DTOç±»ï¼š16
â”‚   â”œâ”€â”€ è¯·æ±‚DTOï¼š1
â”‚   â””â”€â”€ å“åº”DTOï¼š15
â”œâ”€â”€ Repositoryæ¥å£ï¼š5
â”œâ”€â”€ Serviceæ¥å£åŠå®ç°ï¼š2
â”œâ”€â”€ Controllerï¼š1
â”œâ”€â”€ æšä¸¾ç±»ï¼š3
â”œâ”€â”€ å¼‚å¸¸å¤„ç†ï¼š2
â”œâ”€â”€ é…ç½®ç±»ï¼š2
â””â”€â”€ å…¬å…±ç±»ï¼š1

æ•°æ®åº“è¡¨ï¼š5å¼ 
â”œâ”€â”€ t_metricï¼ˆæ ¸å¿ƒæŒ‡æ ‡è¡¨ï¼‰
â”œâ”€â”€ t_attribution_treeï¼ˆå½’å› æ ‘é…ç½®è¡¨ï¼‰
â”œâ”€â”€ t_analysis_taskï¼ˆåˆ†æä»»åŠ¡è¡¨ï¼Œå«roster_idå­—æ®µï¼‰â­
â”œâ”€â”€ t_attribution_resultï¼ˆå½’å› ç»“æœè¡¨ï¼‰
â””â”€â”€ t_ai_reportï¼ˆAIæŠ¥å‘Šè¡¨ï¼‰

APIæ¥å£ï¼š9ä¸ª
â”œâ”€â”€ GET  /attribution/metrics
â”œâ”€â”€ GET  /attribution/metrics/{metricId}/trend
â”œâ”€â”€ GET  /attribution/trees
â”œâ”€â”€ GET  /attribution/trees/{treeId}/config
â”œâ”€â”€ POST /attribution/tasks
â”œâ”€â”€ GET  /attribution/tasks
â”œâ”€â”€ GET  /attribution/tasks/{taskId}/status
â”œâ”€â”€ GET  /attribution/tasks/{taskId}/result
â””â”€â”€ GET  /attribution/tasks/{taskId}/ai-report

æµ‹è¯•è„šæœ¬ï¼š20ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼ˆapi-test.httpï¼‰

===========================================
å…³é”®ç‰¹æ€§
===========================================

âœ… å®Œæ•´çš„RESTful APIå®ç°
âœ… ç»Ÿä¸€çš„å“åº”æ ¼å¼ï¼ˆApiResponseï¼‰
âœ… å…¨å±€å¼‚å¸¸å¤„ç†
âœ… å‚æ•°æ ¡éªŒ
âœ… å¼‚æ­¥ä»»åŠ¡æ‰§è¡Œæ¡†æ¶
âœ… æ”¯æŒåå•IDï¼ˆroster_idï¼‰â­
âœ… JSONçµæ´»å­˜å‚¨ï¼ˆæ ‘ç»“æ„ã€ç»“æœã€æŠ¥å‘Šï¼‰
âœ… åˆ†é¡µæŸ¥è¯¢æ”¯æŒ
âœ… æ¨¡ç³Šæœç´¢æ”¯æŒ
âœ… å®Œæ•´çš„æ—¥å¿—è®°å½•
âœ… äº‹åŠ¡ç®¡ç†
âœ… æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–

===========================================
TODOå¾…å®ç°
===========================================

1. æŒ‡æ ‡è¶‹åŠ¿æŸ¥è¯¢é€»è¾‘
   ä½ç½®ï¼šAttributionServiceImpl.getMetricTrend()
   
2. å½’å› åˆ†ææ ¸å¿ƒç®—æ³• â­â­â­ï¼ˆé‡ç‚¹ï¼‰
   ä½ç½®ï¼šAttributionServiceImpl.executeAttributionAnalysisAsync()
   - æ•°æ®æŸ¥è¯¢æ¨¡å—
   - Adtributorç®—æ³•å®ç°
   - EPå’ŒSurpriseå€¼è®¡ç®—
   - ç»“æœæ ‘æ„å»º
   - AIæŠ¥å‘Šç”Ÿæˆ

===========================================

